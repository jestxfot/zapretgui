# Zapret 20 (Запрет: обход блокировки Discord, YouTube и других сервисов)

Крупнейшее обновление Zapret за всю историю проекта. Полный редизайн интерфейса, новая система стратегий на основе категорий и поддержка Lua-скриптов для гибкой обработки трафика.

---

## Новый интерфейс в стиле Windows 11

Интерфейс был полностью переработан с нуля. Теперь Zapret выглядит как современное Windows 11 приложение:

- **Frameless-окно** — убрана стандартная рамка Windows, добавлен кастомный titlebar с собственными кнопками
- **Скруглённые углы** — мягкий современный дизайн
- **Acrylic/Mica эффект** — полупрозрачное размытие фона в стиле Windows 11
- **Тёмный titlebar** — интерфейс полностью в тёмной теме
- **Сохранение геометрии** — окно запоминает свою позицию и размер между запусками

---

## Новогодние премиум-эффекты

Для подписчиков Premium добавлены праздничные визуальные эффекты:

- **Гирлянда** — анимированные цветные огоньки вдоль верхней части окна
- **Снежинки** — мягко падающие снежинки с физикой движения (покачивание, вращение, прозрачность)

Эффекты можно включить/выключить на странице "Оформление".

---

## Новые темы оформления

Добавлены новые премиум-темы для подписчиков:

- **4 AMOLED-темы** (Синяя, Зелёная, Фиолетовая, Красная) — чёрный фон (#000000) для экономии энергии на OLED-дисплеях
- **Полностью чёрная тема** — pure black для максимальной экономии батареи
- **РКН Тян 2** — новая вариация популярной темы

Все темы переработаны с Windows 11 градиентами и мягкими цветами.

---

## Система категорий стратегий

Вместо плоского списка стратегий теперь используется система категорий с вертикальными вкладками:

- Каждый сервис (Discord, YouTube, GitHub, Steam и др.) имеет свою категорию
- Можно выбирать стратегии из разных категорий одновременно
- Избранные стратегии сохраняются отдельно для каждой категории

### Новые категории стратегий:
- Discord Voice — специальные стратегии для голосовых каналов
- Cloudflare — для сервисов за Cloudflare CDN
- RuTracker — для торрент-трекера
- SoundCloud — для музыкального сервиса
- Speedtest — для тестов скорости интернета
- Battlefield — для игры Battlefield
- Phasmophobia — для игры Phasmophobia
- И многие другие...

---

## Поддержка Lua-скриптов

Zapret 20 добавляет поддержку Lua для гибкой обработки трафика:

- Lua-скрипты позволяют писать кастомные обработчики пакетов
- Скрипты загружаются из папки `lua/`
- Интеграция с движком Zapret 2 (winws2.exe)
- Возможность создавать сложные правила фильтрации

Lua-скрипты открывают новые возможности для продвинутых пользователей, которым нужна тонкая настройка обхода блокировок.

---

## Встроенный редактор стратегий

Новая страница "Редактор" позволяет создавать и редактировать собственные стратегии прямо в интерфейсе:

- Визуальный редактор параметров
- Предпросмотр аргументов командной строки
- Сохранение пользовательских стратегий
- Импорт/экспорт конфигураций

---

## Система блобов

Блобы — это переиспользуемые фрагменты данных (hex-значения, куски TLS/HTTP пакетов):

- Централизованное хранение в `json/blobs.json`
- Системные блобы поставляются с программой
- Возможность создавать пользовательские блобы
- Управление через страницу "Блобы"

---

## Новые страницы интерфейса

- **О программе** — информация о версии, ссылки на обновления и подписку
- **Редактор** — создание и редактирование стратегий
- **Блобы** — управление фрагментами данных
- **Кастомные домены** — добавление собственных доменов для обхода
- **Кастомные IP-наборы** — управление списками IP-адресов

---

## Технические улучшения

### Производительность
- **Асинхронная инициализация** — приложение запускается на ~300мс быстрее
- **Предзагрузка модулей** — PyQt6, requests, qtawesome загружаются в фоновом потоке
- **Кэширование** — избранные стратегии и результаты обработки кэшируются

### Стабильность
- **IPC** — корректная работа с несколькими экземплярами приложения
- **Crash handler** — улучшенная обработка ошибок с детальными логами
- **Проверки при старте** — обнаружение конфликтов с GoodbyeDPI, Kaspersky, mitmproxy

### Автозапуск
- **NSSM интеграция** — управление сервисами через Non-Sucking Service Manager
- **Раздельные режимы** — BAT (Zapret 1) и Direct (Zapret 2) управляются отдельно

---

## Premium

Для подписчиков доступны:
- Новогодние эффекты (гирлянда, снежинки)
- AMOLED-темы и полностью чёрная тема
- Acrylic/Mica эффект размытия
- Приоритетная поддержка
- VPN-сервис

Статус подписки отображается на главной странице.

---

## Скачать

**Ссылки на скачивание:**
- [GitHub Releases](https://github.com/ArkeyV/lupi-dpi-app/releases)
- [Telegram канал](https://t.me/censorliber)

---

*Zapret 20 — это не просто обновление, а полная переработка приложения с новым интерфейсом, новой архитектурой стратегий и поддержкой Lua. Обновляйтесь и пользуйтесь!*