Prefer delegating codebase exploration to subagents; ask questions only when truly blocked; consider several options before making interactive/destructive changes.

Ask questions before changing anything interactively, considering several possible options!

Note: In this repo, multiple agents may work in parallel (e.g. GPT/Codex/Claude). If you see unexpected local changes, assume another agent might be working; don't panic or revert automatically.

## Использование субагентов (чтобы не засорять контекст)

Цель: основной агент (ты) держит контекст "чистым" и сразу понимает, что именно править, а не "лазит по папкам". Для этого максимум поиска/чтения/анализа отдаём субагентам.

- Для анализа кода (поиск по проекту, чтение множества файлов, трассировка потоков, выявление места бага) сначала запускай `Task` субагента `explore`.
- Для прод-отладки/триажа инцидентов (гипотезы причин, команды проверки, план ремедиации) запускай `Task` субагента `general`.
- Основной агент читает файлы напрямую только когда:
  - нужно внести конкретный патч (точечное изменение);
  - нужно проверить финальный контекст вокруг правки.
- Проси субагента возвращать "готовый ответ":
  - точные пути файлов (`path/to/file.py`) и названия функций/классов;
  - 1-3 ключевые причины/гипотезы;
  - конкретное предложение исправления (минимальный патч/псевдопатч);
  - команды для проверки (тесты/запуск/диагностика).

Рекомендуемый шаблон запроса субагенту (коротко и по делу):

```text
Проанализируй <симптом/лог/вопрос>. Найди место в коде, где это возникает, и предложи минимальное исправление.
Верни: (1) файлы+символы, (2) корень проблемы, (3) точечный фикс, (4) как проверить.
```

“Make sure to commit every change, as the code sometimes gets reset.

Git workflow (auto-commit + push)

- После любых изменений в коде/конфигах: делай коммит (обычно 1 коммит на задачу/запрос), не оставляй изменения незакоммиченными.
- По умолчанию после каждого успешного коммита: делай `git push upstream` на текущую ветку.
- Не полагайся на `origin` (форк может отсутствовать/быть удален).
- Если push невозможен (нет remote/прав/инета): сообщи об ошибке и оставь локальный коммит.
- Никогда не используй `--force`/`--force-with-lease`.
- Никогда не меняй git config.

hosts.ini (каталог доменов)

- Канонический путь каталога: `<repo>/json/hosts.ini` (рядом с репозиторием).
- Для exe-сборки это тоже внешний файл рядом с папкой приложения: `<exe_dir>/json/hosts.ini`.
- Единственный валидный путь: внешний `./json/hosts.ini` (рядом с репой или рядом с exe).
- Любые пути вида `.../_internal/json/hosts.ini`, `sys._MEIPASS/...` и вычисление от `__file__` внутри frozen-бандла считаются багом и должны быть устранены (не использовать как fallback).

Обязательно перед каждым `git commit`:
- проверь, что staged-изменения содержат актуальный код: `git diff --staged`

Обязательно сразу после каждого коммита:
- проверь, что в коммите именно последние изменения (а не старый код): `git show --stat` и при необходимости `git show`
